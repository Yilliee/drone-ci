From 8db1d9160b7890a13721c2bd70514cd1798a2994 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Yilli=C3=A9?= <yilliee@protonmail.com>
Date: Tue, 21 Jun 2022 08:47:34 +0500
Subject: [PATCH 3/3] Allow changing vertical alignment of status bar icons
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

- If the var TW_STATUS_ICONS_ALIGN can be set to:
   1) 'center' or '2' to center-align the icons/text (vertically)
   2) 'bottom' or '3' to bottom-align the icons/text (vertically)
  ( Value calculated by utilizing statusbar height & size of font_m ).
- If set to anything else or not set at all, it falls back to twrp's
  old behaviour of top-aligning the status bar icons.

Change-Id: I1b292221f3c34bbac20233595fbc0958d4aa4cc1
Signed-off-by: Yilli√© <yilliee@protonmail.com>
Signed-off-by: Mohd Faraz <androiabledroid@gmail.com>
---
 gui/libguitwrp_defaults.go      | 7 +++++++
 gui/theme/landscape_hdpi/ui.xml | 5 ++++-
 gui/theme/landscape_mdpi/ui.xml | 5 ++++-
 gui/theme/portrait_hdpi/ui.xml  | 5 ++++-
 gui/theme/portrait_mdpi/ui.xml  | 5 ++++-
 gui/theme/watch_mdpi/ui.xml     | 5 ++++-
 6 files changed, 27 insertions(+), 5 deletions(-)

diff --git a/gui/libguitwrp_defaults.go b/gui/libguitwrp_defaults.go
index 258ac8daf..faa842699 100644
--- a/gui/libguitwrp_defaults.go
+++ b/gui/libguitwrp_defaults.go
@@ -97,6 +97,13 @@ func copyThemeResources(ctx android.BaseContext, dirs []string, files []string)
 			newFile = strings.Replace(newFile, "{battery_pos}", props[0], -1)
 			newFile = strings.Replace(newFile, "{clock_pos}", props[1], -1)
 			newFile = strings.Replace(newFile, "{cpu_pos}", props[2], -1)
+			alignProp := "%status_topalign_header_y%"
+			if getMakeVars(ctx, "TW_STATUS_ICONS_ALIGN") == "center" || getMakeVars(ctx, "TW_STATUS_ICONS_ALIGN") == "2" {
+				alignProp = "%status_centeralign_header_y%"
+			} else if getMakeVars(ctx, "TW_STATUS_ICONS_ALIGN") == "bottom" || getMakeVars(ctx, "TW_STATUS_ICONS_ALIGN") == "3" {
+				alignProp = "%status_bottomalign_header_y%"
+			}
+			newFile = strings.Replace(newFile, "{statusicons_align}", alignProp, -1)
 		}
 		err = ioutil.WriteFile(twRes + i, []byte(newFile), 0)
 		if err != nil {
diff --git a/gui/theme/landscape_hdpi/ui.xml b/gui/theme/landscape_hdpi/ui.xml
index 8ce6a6a5d..0948c8cd5 100755
--- a/gui/theme/landscape_hdpi/ui.xml
+++ b/gui/theme/landscape_hdpi/ui.xml
@@ -119,7 +119,10 @@
 		<variable name="btn4_col2_x_right" value="1218"/>
 		<variable name="btn4_col3_x_right" value="1452"/>
 		<variable name="btn4_col4_x_right" value="1686"/>
-		<variable name="row1_header_y" value="0"/>
+		<variable name="status_topalign_header_y" value="0"/>
+		<variable name="status_centeralign_header_y" value="8"/>
+		<variable name="status_bottomalign_header_y" value="16"/>
+		<variable name="row1_header_y" value="{statusicons_alignment}"/>
 		<variable name="row2_header_y" value="48"/>
 		<variable name="row3_header_y" value="60"/>
 		<variable name="row4_header_y" value="126"/>
diff --git a/gui/theme/landscape_mdpi/ui.xml b/gui/theme/landscape_mdpi/ui.xml
index 02f4e3990..e28043b9c 100755
--- a/gui/theme/landscape_mdpi/ui.xml
+++ b/gui/theme/landscape_mdpi/ui.xml
@@ -119,7 +119,10 @@
 		<variable name="btn4_col2_x_right" value="507"/>
 		<variable name="btn4_col3_x_right" value="606"/>
 		<variable name="btn4_col4_x_right" value="703"/>
-		<variable name="row1_header_y" value="0"/>
+		<variable name="status_topalign_header_y" value="0"/>
+		<variable name="status_centeralign_header_y" value="2"/>
+		<variable name="status_bottomalign_header_y" value="4"/>
+		<variable name="row1_header_y" value="{statusicons_align}"/>
 		<variable name="row2_header_y" value="20"/>
 		<variable name="row3_header_y" value="24"/>
 		<variable name="row4_header_y" value="52"/>
diff --git a/gui/theme/portrait_hdpi/ui.xml b/gui/theme/portrait_hdpi/ui.xml
index 14fdb3e6c..a06383edf 100755
--- a/gui/theme/portrait_hdpi/ui.xml
+++ b/gui/theme/portrait_hdpi/ui.xml
@@ -113,7 +113,10 @@
 		<variable name="btn4_col2_x" value="297"/>
 		<variable name="btn4_col3_x" value="558"/>
 		<variable name="btn4_col4_x" value="819"/>
-		<variable name="row1_header_y" value="4"/>
+		<variable name="status_topalign_header_y" value="4"/>
+		<variable name="status_centeralign_header_y" value="15"/>
+		<variable name="status_bottomalign_header_y" value="30"/>
+		<variable name="row1_header_y" value="{statusicons_align}"/>
 		<variable name="row2_header_y" value="72"/>
 		<variable name="row3_header_y" value="90"/>
 		<variable name="row4_header_y" value="168"/>
diff --git a/gui/theme/portrait_mdpi/ui.xml b/gui/theme/portrait_mdpi/ui.xml
index dbcb1d188..3893a39d3 100755
--- a/gui/theme/portrait_mdpi/ui.xml
+++ b/gui/theme/portrait_mdpi/ui.xml
@@ -113,7 +113,10 @@
 		<variable name="btn4_col2_x" value="131"/>
 		<variable name="btn4_col3_x" value="247"/>
 		<variable name="btn4_col4_x" value="363"/>
-		<variable name="row1_header_y" value="2"/>
+		<variable name="status_topalign_header_y" value="2"/>
+		<variable name="status_centeralign_header_y" value="6"/>
+		<variable name="status_bottomalign_header_y" value="12"/>
+		<variable name="row1_header_y" value="{statusicons_align}"/>
 		<variable name="row2_header_y" value="30"/>
 		<variable name="row3_header_y" value="40"/>
 		<variable name="row4_header_y" value="74"/>
diff --git a/gui/theme/watch_mdpi/ui.xml b/gui/theme/watch_mdpi/ui.xml
index a76bbdd1f..1b6865b87 100644
--- a/gui/theme/watch_mdpi/ui.xml
+++ b/gui/theme/watch_mdpi/ui.xml
@@ -96,7 +96,10 @@
 		<variable name="btn4_col2_x" value="86"/>
 		<variable name="btn4_col3_x" value="164"/>
 		<variable name="btn4_col4_x" value="242"/>
-		<variable name="row1_header_y" value="0"/>
+		<variable name="status_topalign_header_y" value="0"/>
+		<variable name="status_centeralign_header_y" value="3"/>
+		<variable name="status_bottomalign_header_y" value="6"/>
+		<variable name="row1_header_y" value="{statusicons_align}"/>
 		<variable name="row2_header_y" value="20"/>
 		<variable name="row1_y" value="28"/>
 		<variable name="row1a_y" value="36"/>
-- 
2.36.1

